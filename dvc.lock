schema: '2.0'
stages:
  prepare:
    cmd: python -m dh_modelling.prepare --input data/raw/hki_dh_2015_2020_a.csv --fmi-dir
      data/raw/fmi --fmi-station-name "Helsinki Kaisaniemi" --output data/intermediate/prepared.feather
    deps:
    - path: data/raw/fmi
      md5: b88efcc82005efece1517ceb2f366cbc.dir
      size: 3326479
      nfiles: 14
    - path: data/raw/hki_dh_2015_2020_a.csv
      md5: a5ec283006abb2d2758d4aefb4b2d402
      size: 1293525
    - path: dh_modelling/prepare.py
      md5: 258fe2a2dc6350a186ea4f2b32192af1
      size: 7709
    outs:
    - path: data/intermediate/prepared.feather
      md5: 2dea54fd98f93fca994c9ebe0d77bbc2
      size: 842234
  featurize:
    cmd: python -m dh_modelling.featurize --input data/intermediate/prepared.feather
      --output data/intermediate/features.feather
    deps:
    - path: data/intermediate/prepared.feather
      md5: 2dea54fd98f93fca994c9ebe0d77bbc2
      size: 842234
    - path: dh_modelling/featurize.py
      md5: 8d3f4a97e69c5dd259cfa8920f082e97
      size: 2908
    outs:
    - path: data/intermediate/features.feather
      md5: cc0560ed53dde7a2e7d5b511c309d9a6
      size: 1149626
  train:
    cmd: python -m dh_modelling.train --train-path data/processed/train.feather --model-path
      models/model.bin --objective reg:squarederror --num-boost-round 2000 --tree-method
      hist --max-depth 5 --min-child-weight 5 --eta 0.1 --subsample 0.9 --colsample-bytree
      0.9
    deps:
    - path: data/processed/train.feather
      md5: 9ec822a16d3f92c1df72dd6495cc4783
      size: 920298
    - path: dh_modelling/train.py
      md5: 516adf3d7435a4db8759410e986c556e
      size: 2550
    outs:
    - path: models/model.bin
      md5: 192170a358f3764da64053c6d098e155
      size: 4558272
  evaluate:
    cmd: python -m dh_modelling.evaluate --model-path models/model.bin --test-path
      data/processed/test.feather --metrics-path output/score.json
    deps:
    - path: data/processed/test.feather
      md5: 2432d4f643c0d195d2fc898dc96b0a72
      size: 234434
    - path: dh_modelling/evaluate.py
      md5: 2cf53287542e93cd83720fc737398bcd
      size: 2238
    - path: models/model.bin
      md5: 192170a358f3764da64053c6d098e155
      size: 4558272
    outs:
    - path: output/score.json
      md5: ad6c9bab5c7d4d4d0eab8fecb82a88cb
      size: 143
  split:
    cmd: python -m dh_modelling.split --input data/intermediate/features.feather --test-size
      0.2 --train-output data/processed/train.feather --test-output data/processed/test.feather
    deps:
    - path: data/intermediate/features.feather
      md5: cc0560ed53dde7a2e7d5b511c309d9a6
      size: 1149626
    - path: dh_modelling/split.py
      md5: cc7498adfaac8dc8b76e3f6c4c4eaa65
      size: 1938
    outs:
    - path: data/processed/test.feather
      md5: 2432d4f643c0d195d2fc898dc96b0a72
      size: 234434
    - path: data/processed/train.feather
      md5: 9ec822a16d3f92c1df72dd6495cc4783
      size: 920298
